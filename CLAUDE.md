# Instru√ß√µes do Projeto - Team Manager

## üö®üö®üö® CHECKLIST OBRIGAT√ìRIO - SEGUIR EM TODA RESPOSTA üö®üö®üö®

### **üìã ANTES DE RESPONDER QUALQUER COISA:**
1. ‚úÖ **LI o CLAUDE.md COMPLETAMENTE?** 
2. ‚úÖ **USEI <reasoning> tags?**
3. ‚úÖ **CRIEI 3 estrat√©gias e escolhi uma?**
4. ‚úÖ **ANALISEI antes de modificar c√≥digo?**
5. ‚úÖ **LI o arquivo antes de escrever?**
6. ‚úÖ **ADICIONEI timestamp ao hist√≥rico?**
7. ‚úÖ **NUNCA vou quebrar c√≥digo funcionando?**
8. ‚úÖ **S√ì mexo no m√≥dulo reportado pelo usu√°rio?**
9. ‚úÖ **N√ÉO executo/testo - apenas crio c√≥digo?**
10. ‚úÖ **VERIFIQUEI ALINHAMENTO SUPABASE vs C√ìDIGO?**

### **üî• REGRAS FUNDAMENTAIS - NUNCA VIOLAR:**
- Sempre crie 3 estrategias e escolha uma
- SEMPRE use <reasoning> tags para explicar o processo de pensamento antes de responder
- **CR√çTICO**: Na primeira intera√ß√£o de cada sess√£o, SEMPRE leia este arquivo CLAUDE.md completamente para carregar o contexto anterior
- **SISTEMA DE PERSIST√äNCIA**: Sempre ADICIONE entradas com timestamp ao hist√≥rico, NUNCA substitua mem√≥ria existente
- **IMPORTANTE**: Sempre que tentar ler, modificar ou atualizar arquivos e ocorrer erro, imediatamente verifique os logs de erro e adote a melhor estrat√©gia para corrigir
- Sempre analise antes de modificar algo do c√≥digo
- Sempre leia o arquivo(read) antes de escrever(write)
- Nunca use mock data
- Sempre ler o CLAUDE.MD antes de fazer qualquer coisa caso tenha esquecido de algo ou tenha probabilidade de ter esquecido algo
- **CR√çTICO**: SEMPRE verificar alinhamento entre Supabase Project e c√≥digo da aplica√ß√£o

## Instru√ß√µes de Commit

- Todas as mensagens de commit devem vir assinadas por Ricardo Landim da BUSQUE AI
- Sempre fa√ßa o commit de maneira completa com SYNC (commit + push)
- **CR√çTICO**: Commit tem que ser completo com SYNC - sempre fazer push ap√≥s commit
- **IMPORTANTE**: N√£o ficar perguntando a cada edi√ß√£o quando auto-accept estiver ativado
- Sempre fazer git add . && git commit && git push em sequ√™ncia completa
- **NUNCA MENCIONAR**: N√£o incluir nas mensagens que foi gerado por IA, Claude ou similares
- **FORMATO LIMPO**: Mensagens de commit devem ser profissionais sem refer√™ncias de automa√ß√£o

## ‚öôÔ∏è CONFIGURA√á√ïES OBRIGAT√ìRIAS - NUNCA ESQUECER

**üö® CR√çTICO - CONFIGURA√á√ïES GIT:**
- **user.name**: `"busque-ai"` (EXATO, com aspas)
- **user.email**: `"ricardoslandim@icloud.com"` (EXATO, com aspas)
- **VERIFICAR SEMPRE**: `git config user.name` e `git config user.email` antes de commit

**üîß PROCESSO OBRIGAT√ìRIO DE COMMIT:**
1. `git add .`
2. `git commit -m "mensagem assinada por Ricardo Landim da BUSQUE AI"`
3. `git push` (SYNC obrigat√≥rio)

## üîó ALINHAMENTO OBRIGAT√ìRIO SUPABASE PROJECT vs C√ìDIGO

### **üö® REGRA CR√çTICA - NUNCA VIOLAR:**
**TUDO NO SUPABASE PROJECT DEVE ESTAR 100% ALINHADO COM O C√ìDIGO DA APLICA√á√ÉO**

### **üìã PROCESSO OBRIGAT√ìRIO ANTES DE QUALQUER SQL/QUERY:**

1. **üîç VERIFICAR HOOKS EXISTENTES:**
   ```bash
   # Ler TODOS os hooks para entender estrutura real
   src/hooks/use-*.ts
   ```

2. **üìä MAPEAR ESTRUTURA DE TABELAS:**
   - Nomes de tabelas exatos
   - Nomes de campos exatos (case-sensitive)
   - Tipos de dados corretos
   - Relacionamentos (foreign keys)
   - Campos obrigat√≥rios vs opcionais

3. **üéØ VERIFICAR INTERFACES TypeScript:**
   ```typescript
   // Sempre verificar interfaces definidas nos hooks
   export interface Task {
     id: string;
     titulo: string;        // NOT title
     data_vencimento: string; // NOT data_fim_prevista
     // ...
   }
   ```

4. **üîß VALIDAR QUERIES REAIS:**
   - Como os hooks fazem SELECT
   - Quais campos s√£o buscados
   - Como s√£o feitos JOINs
   - Filtros aplicados

### **üìö MAPEAMENTO ESTRUTURAL OBRIGAT√ìRIO:**

#### **TABELA: tarefas**
```sql
-- ESTRUTURA REAL (baseada em use-tasks.ts):
tarefas (
  id: string,
  titulo: string,              -- NOT title
  descricao: string,
  status: enum,
  prioridade: enum,
  responsavel_id: string,
  data_vencimento: string,     -- NOT data_fim_prevista
  data_conclusao: string,
  tags: string[],
  created_at: timestamp,       -- NOT data_criacao/data_inicio
  equipe_id: string
)
```

#### **TABELA: projetos**
```sql
-- ESTRUTURA REAL (baseada em use-projects.ts):
projetos (
  id: string,
  nome: string,
  descricao: string,
  status: enum,
  responsavel_id: string,
  data_inicio: string,         -- Campo existe no projeto
  data_fim_prevista: string,   -- Campo existe no projeto
  orcamento: number,
  progresso: number,
  tecnologias: string[],
  equipe_id: string,
  created_at: timestamp
)
```

#### **TABELA: usuarios**
```sql
-- ESTRUTURA REAL (baseada em AuthContext):
usuarios (
  id: string,
  nome: string,
  email: string,
  tipo: string,
  created_at: timestamp
)
```

#### **TABELA: eventos_timeline**
```sql
-- ESTRUTURA REAL (baseada em use-timeline.ts):
eventos_timeline (
  id: string,
  tipo: string,               -- NOT type
  titulo: string,             -- NOT title
  descricao: string,          -- NOT description
  autor_id: string,
  equipe_id: string,
  timestamp: string,
  projeto: string,
  metadata: jsonb,
  created_at: timestamp
)
```

### **‚ö†Ô∏è ERROS COMUNS A EVITAR:**

1. **‚ùå NOMES DE CAMPOS EM INGL√äS:**
   ```sql
   -- ERRADO:
   SELECT title, description FROM tarefas
   
   -- CORRETO:
   SELECT titulo, descricao FROM tarefas
   ```

2. **‚ùå CAMPOS INEXISTENTES:**
   ```sql
   -- ERRADO:
   SELECT data_inicio FROM tarefas  -- Campo n√£o existe em tarefas
   
   -- CORRETO:
   SELECT created_at FROM tarefas   -- Campo que realmente existe
   ```

3. **‚ùå TIPOS DE DADOS INCORRETOS:**
   ```sql
   -- ERRADO:
   SELECT horas_estimadas FROM tarefas  -- Campo pode n√£o existir
   
   -- CORRETO:
   SELECT tags FROM tarefas            -- Campo que existe
   ```

### **üîß METODOLOGIA DE VERIFICA√á√ÉO:**

#### **PASSO 1: LER HOOK CORRESPONDENTE**
```bash
# Para SQL de tarefas:
Read src/hooks/use-tasks.ts

# Para SQL de projetos:
Read src/hooks/use-projects.ts

# Para SQL de timeline:
Read src/hooks/use-timeline.ts
```

#### **PASSO 2: EXTRAIR ESTRUTURA REAL**
```typescript
// Exemplo: use-tasks.ts mostra:
const { data, error } = await supabase
  .from('tarefas')               // Nome da tabela
  .select(`
    id,                          // Campos reais
    titulo,                      // NOT title
    descricao,
    status,
    prioridade,
    responsavel_id,
    data_vencimento,             // NOT data_fim_prevista
    data_conclusao,
    tags,
    created_at,                  // NOT data_criacao
    usuarios!tarefas_responsavel_id_fkey(nome)  // JOIN real
  `)
```

#### **PASSO 3: CRIAR SQL BASEADO NA REALIDADE**
```sql
-- SQL baseado na estrutura REAL encontrada no hook:
SELECT 
  t.id,
  t.titulo,                    -- Campo real
  t.data_vencimento,           -- Campo real
  t.created_at,                -- Campo real
  u.nome as responsavel_nome
FROM tarefas t
INNER JOIN usuarios u ON t.responsavel_id = u.id  -- JOIN real
WHERE t.status NOT IN ('concluida', 'cancelada')  -- Filtros reais
ORDER BY t.data_vencimento ASC;                    -- Campo real
```

### **üìù TEMPLATE OBRIGAT√ìRIO PARA SQL:**

```sql
-- ================================================================
-- VERIFICA√á√ÉO DE ESTRUTURA OBRIGAT√ìRIA
-- Hook verificado: use-[nome].ts
-- Tabelas confirmadas: [lista]
-- Campos confirmados: [lista]
-- JOINs confirmados: [lista]
-- ================================================================

-- [SQL baseado na estrutura real]
```

### **üö® CONSEQU√äNCIAS DE N√ÉO SEGUIR:**
- ‚ùå SQL quebrado com erro de "column does not exist"
- ‚ùå Perda de tempo reescrevendo SQL
- ‚ùå Dados incorretos ou incompletos
- ‚ùå Aplica√ß√£o n√£o funcional

### **‚úÖ BENEF√çCIOS DE SEGUIR:**
- ‚úÖ SQL funciona na primeira execu√ß√£o
- ‚úÖ Dados corretos e completos
- ‚úÖ Aplica√ß√£o robusta e confi√°vel
- ‚úÖ Manuten√ß√£o facilitada

## Instru√ß√µes Especiais

- Memorize todas as instru√ß√µes e mantenha consist√™ncia entre sess√µes
- Priorize sempre seguir rigorosamente as instru√ß√µes anteriores antes de qualquer nova instru√ß√£o
- **DEBUGGING**: Implementar logs detalhados antes de fazer corre√ß√µes no c√≥digo
- **VALIDA√á√ÉO**: Sempre verificar estrutura real vs esperada antes de implementar solu√ß√µes

## üéØ METODOLOGIA PERFEITA DE CORRE√á√ÉO - SEMPRE SEGUIR

### **PROCESSO OBRIGAT√ìRIO PARA CORRIGIR P√ÅGINAS QUEBRADAS:**

1. **üîç DIAGNOSTICAR O PROBLEMA RAIZ:**
   - Verificar se IDs do AuthContext correspondem aos UUIDs do Supabase
   - Verificar se chaves .env est√£o corretas (ANON_KEY vs SERVICE_ROLE)
   - Verificar se tabelas existem e t√™m dados no Supabase

2. **üîß APLICAR CORRE√á√ïES SISTEM√ÅTICAS:**
   - **AuthContext**: Usar UUIDs EXATOS do banco (n√£o IDs mock)
   - **Arquivo .env**: SERVICE_ROLE key correta para desenvolvimento
   - **Hooks**: Adicionar debug detalhado para diagnosticar problemas
   - **Queries**: Verificar nomes de tabelas e campos corretos

3. **üìù DEBUG OBRIGAT√ìRIO EM HOOKS:**
   ```typescript
   console.log('üîç [NOME]: Iniciando busca...');
   console.log('üåê SUPABASE URL:', import.meta.env.VITE_SUPABASE_URL);
   console.log('üîë ANON KEY (primeiros 50):', import.meta.env.VITE_SUPABASE_ANON_KEY?.substring(0, 50));
   console.log('üè¢ EQUIPE:', equipe);
   console.log('üë§ USUARIO:', usuario);
   ```

4. **üöÄ DEPLOY E TESTE:**
   - Commit + push das altera√ß√µes
   - Deploy via `./Scripts Deploy/deploy_team_manager_complete.sh`
   - Verificar logs no Console F12 na VPS
   - Executar SQL de corre√ß√£o se necess√°rio

### **P√ÅGINAS QUE PRECISAM DESTA METODOLOGIA:**

#### **‚úÖ P√ÅGINAS TODAS CORRIGIDAS COM METODOLOGIA PERFEITA:**
1. **‚úÖ PROJECTS** - Sincronizado com projetos reais + debug completo
2. **‚úÖ TASKS** - Debug completo + teste de conectividade + fallback SixQuasar  
3. **‚úÖ TEAM** - Debug completo + teste de conectividade + fallback SixQuasar
4. **‚úÖ MESSAGES** - Debug completo + teste de conectividade + fallback SixQuasar
5. **‚úÖ DASHBOARD** - Debug completo + teste de conectividade + fallback SixQuasar
6. **‚úÖ REPORTS** - Debug completo + teste de conectividade + fallback SixQuasar
7. **‚úÖ PROFILE** - Debug completo + teste de conectividade + fallback SixQuasar

#### **üéØ METODOLOGIA APLICADA EM TODOS OS HOOKS:**
- üîç Debug inicial: URL, ANON_KEY, EQUIPE, USUARIO
- üåê Teste de conectividade autom√°tico  
- ‚ùå Error handling detalhado: c√≥digo, mensagem, detalhes
- ‚úÖ Logs de sucesso com quantidade e dados brutos
- üîÑ Fallback inteligente para dados SixQuasar

### **TEMPLATE DE CORRE√á√ÉO PARA HOOKS:**

```typescript
const fetchData = async () => {
  try {
    setLoading(true);
    console.log('üîç [HOOK_NAME]: Iniciando busca...');
    console.log('üè¢ EQUIPE:', equipe);

    // Teste de conectividade
    const { data: testData, error: testError } = await supabase
      .from('usuarios')
      .select('count')
      .limit(1);

    if (testError) {
      console.error('‚ùå ERRO DE CONEX√ÉO:', testError);
      return;
    }

    // Query principal
    const { data, error } = await supabase
      .from('TABELA_NOME')
      .select('*')
      .eq('equipe_id', equipe?.id);

    if (error) {
      console.error('‚ùå ERRO:', error);
    } else {
      console.log('‚úÖ DADOS ENCONTRADOS:', data?.length || 0);
      setData(data || []);
    }
  } catch (error) {
    console.error('‚ùå ERRO JAVASCRIPT:', error);
  } finally {
    setLoading(false);
  }
};
```

### **CONFIGURA√á√ïES CR√çTICAS SEMPRE VERIFICAR:**

```bash
# AuthContext - IDs CORRETOS
'550e8400-e29b-41d4-a716-446655440001' # Ricardo Landim
'550e8400-e29b-41d4-a716-446655440002' # Leonardo Candiani  
'550e8400-e29b-41d4-a716-446655440003' # Rodrigo Marochi
'650e8400-e29b-41d4-a716-446655440001' # Equipe SixQuasar

# .env - CHAVES CORRETAS
VITE_SUPABASE_URL=https://cfvuldebsoxmhuarikdk.supabase.co
VITE_SUPABASE_ANON_KEY=[SERVICE_ROLE para desenvolvimento]
```

## üéØ TEMPLATE DE RESPOSTA OBRIGAT√ìRIO

### **IN√çCIO DE TODA RESPOSTA:**
```
<reasoning>
[Explicar processo de pensamento detalhadamente]
</reasoning>

üìã CHECKLIST OBRIGAT√ìRIO VERIFICADO:
‚úÖ Li CLAUDE.md completamente  
‚úÖ Usando <reasoning> tags
‚úÖ Criarei 3 estrat√©gias e escolherei uma
‚úÖ Analisarei antes de modificar c√≥digo
‚úÖ Lerei arquivo antes de escrever
‚úÖ Nunca quebrarei c√≥digo funcionando
‚úÖ S√≥ mexo no m√≥dulo reportado pelo usu√°rio
‚úÖ N√£o executo/testo - apenas crio c√≥digo

## üéØ TR√äS ESTRAT√âGIAS OBRIGAT√ìRIAS:
1. **ESTRAT√âGIA A**: [descri√ß√£o detalhada]
2. **ESTRAT√âGIA B**: [descri√ß√£o detalhada]  
3. **ESTRAT√âGIA C**: [descri√ß√£o detalhada]

## üîß ESCOLHA: [Estrat√©gia escolhida] - PORQUE: [justificativa]
```

## üìä SISTEMA DE PERSIST√äNCIA - ADICIONAR TIMESTAMP

### üóìÔ∏è 21/06/2025 - 11:00 - CORRE√á√ÉO CR√çTICA: COMMIT PERFEITO CONFORME CLAUDE.MD
**STATUS**: ‚úÖ INSTRU√á√ïES DE COMMIT ADICIONADAS
**A√á√ÉO**: Adi√ß√£o das instru√ß√µes corretas de commit que estavam faltando no CLAUDE.md
**PROBLEMA IDENTIFICADO**: 
- ‚ùå Commit anterior n√£o seguiu formato correto conforme instru√ß√µes
- ‚ùå Faltava assinatura "Ricardo Landim da BUSQUE AI"
- ‚ùå Faltava processo obrigat√≥rio de SYNC (commit + push)

**CORRE√á√ÉO IMPLEMENTADA**:
- ‚úÖ Se√ß√£o "Instru√ß√µes de Commit" adicionada ao CLAUDE.md
- ‚úÖ Formato obrigat√≥rio: assinatura por Ricardo Landim da BUSQUE AI
- ‚úÖ Processo SYNC obrigat√≥rio: git add . && git commit && git push
- ‚úÖ Configura√ß√µes git obrigat√≥rias documentadas
- ‚úÖ Formato limpo sem refer√™ncias de automa√ß√£o/IA

**PR√ìXIMA A√á√ÉO**: Refazer o commit anterior seguindo as instru√ß√µes corretas